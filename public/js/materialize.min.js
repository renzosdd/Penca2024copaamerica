(function(){
 if(window.M) return; 
 function initDropdown(elems){
  return Array.from(elems).map(function(el){
    var target=document.getElementById(el.dataset.target);
    if(!target) return; 
    function toggle(e){e.preventDefault();target.classList.toggle('open');}
    el.addEventListener('click',toggle);
    document.addEventListener('click',function(e){if(!el.contains(e.target)&&!target.contains(e.target))target.classList.remove('open');});
    return{open:function(){target.classList.add('open');},close:function(){target.classList.remove('open');}};
  });
 }
 function initModal(elems){
  return Array.from(elems).map(function(el){
    var overlay=document.createElement('div');
    overlay.className='modal-overlay';
    document.body.appendChild(overlay);
    function open(){el.classList.add('open');overlay.classList.add('open');}
    function close(){el.classList.remove('open');overlay.classList.remove('open');}
    overlay.addEventListener('click',close);
    el.querySelectorAll('.modal-close').forEach(function(btn){btn.addEventListener('click',close);});
    return{open:open,close:close};
  });
 }
 function initTabs(elems){
  Array.from(elems).forEach(function(tab){
    tab.querySelectorAll('a').forEach(function(a){
      a.addEventListener('click',function(e){
        e.preventDefault();
        var active=tab.querySelector('.active');
        if(active) active.classList.remove('active');
        a.classList.add('active');
      });
    });
  });
 }
 function initCollapsible(elems){
  Array.from(elems).forEach(function(col){
    col.querySelectorAll('.collapsible-header').forEach(function(h){
      h.addEventListener('click',function(){
        h.classList.toggle('active');
        var body=h.nextElementSibling;
        if(body) body.style.display=body.style.display==='block'?'none':'block';
      });
    });
  });
 }
 window.M={
  Dropdown:{init:initDropdown},
  Modal:{init:initModal,getInstance:function(el){return{open:function(){el.classList.add('open');document.querySelectorAll('.modal-overlay').forEach(function(o){o.classList.add('open');});},close:function(){el.classList.remove('open');document.querySelectorAll('.modal-overlay').forEach(function(o){o.classList.remove('open');});}}},
  Tabs:{init:initTabs},
  FormSelect:{init:function(){return[];}},
  Sidenav:{init:function(){return[];}},
  Collapsible:{init:initCollapsible},
  toast:function(opts){var t=document.createElement('div');t.className='toast';t.textContent=opts.html||'';document.body.appendChild(t);setTimeout(function(){t.remove();},4000);},
  updateTextFields:function(){}
 };
})();
